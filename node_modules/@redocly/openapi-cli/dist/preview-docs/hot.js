"use strict";

/* eslint-disable no-underscore-dangle */
(function run() {
  const Socket = window.SimpleWebsocket;
  const port = window.__OPENAPI_CLI_WS_PORT;
  let socket;
  reconnect();

  function reconnect() {
    socket = new Socket(`ws://127.0.0.1:${port}`);
    socket.on('connect', () => {
      socket.send('{"type": "ping"}');
    });
    socket.on('data', data => {
      const message = JSON.parse(data);

      switch (message.type) {
        case 'pong':
          console.log('[hot] hot reloading connected');
          break;

        case 'reload':
          console.log('[hot] full page reload');
          window.location.reload();
          break;

        default:
          console.log(`[hot] ${message.type} received`);
      }
    });
    socket.on('close', () => {
      socket.destroy();
      console.log('Connection lost, trying to reconnect in 4s');
      setTimeout(() => {
        reconnect();
      }, 4000);
    });
    socket.on('error', () => {
      socket.destroy();
    });
  }
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wcmV2aWV3LWRvY3MvaG90LmpzIl0sIm5hbWVzIjpbInJ1biIsIlNvY2tldCIsIndpbmRvdyIsIlNpbXBsZVdlYnNvY2tldCIsInBvcnQiLCJfX09QRU5BUElfQ0xJX1dTX1BPUlQiLCJzb2NrZXQiLCJyZWNvbm5lY3QiLCJvbiIsInNlbmQiLCJkYXRhIiwibWVzc2FnZSIsIkpTT04iLCJwYXJzZSIsInR5cGUiLCJjb25zb2xlIiwibG9nIiwibG9jYXRpb24iLCJyZWxvYWQiLCJkZXN0cm95Iiwic2V0VGltZW91dCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNDLFVBQVNBLEdBQVQsR0FBZTtBQUNkLFFBQU1DLE1BQU0sR0FBR0MsTUFBTSxDQUFDQyxlQUF0QjtBQUNBLFFBQU1DLElBQUksR0FBR0YsTUFBTSxDQUFDRyxxQkFBcEI7QUFFQSxNQUFJQyxNQUFKO0FBRUFDLEVBQUFBLFNBQVM7O0FBRVQsV0FBU0EsU0FBVCxHQUFxQjtBQUNuQkQsSUFBQUEsTUFBTSxHQUFHLElBQUlMLE1BQUosQ0FBWSxrQkFBaUJHLElBQUssRUFBbEMsQ0FBVDtBQUNBRSxJQUFBQSxNQUFNLENBQUNFLEVBQVAsQ0FBVSxTQUFWLEVBQXFCLE1BQU07QUFDekJGLE1BQUFBLE1BQU0sQ0FBQ0csSUFBUCxDQUFZLGtCQUFaO0FBQ0QsS0FGRDtBQUlBSCxJQUFBQSxNQUFNLENBQUNFLEVBQVAsQ0FBVSxNQUFWLEVBQW1CRSxJQUFELElBQVU7QUFDMUIsWUFBTUMsT0FBTyxHQUFHQyxJQUFJLENBQUNDLEtBQUwsQ0FBV0gsSUFBWCxDQUFoQjs7QUFDQSxjQUFRQyxPQUFPLENBQUNHLElBQWhCO0FBQ0UsYUFBSyxNQUFMO0FBQ0VDLFVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLCtCQUFaO0FBQ0E7O0FBQ0YsYUFBSyxRQUFMO0FBQ0VELFVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHdCQUFaO0FBQ0FkLFVBQUFBLE1BQU0sQ0FBQ2UsUUFBUCxDQUFnQkMsTUFBaEI7QUFDQTs7QUFDRjtBQUNFSCxVQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBYSxTQUFRTCxPQUFPLENBQUNHLElBQUssV0FBbEM7QUFUSjtBQVdELEtBYkQ7QUFlQVIsSUFBQUEsTUFBTSxDQUFDRSxFQUFQLENBQVUsT0FBVixFQUFtQixNQUFNO0FBQ3ZCRixNQUFBQSxNQUFNLENBQUNhLE9BQVA7QUFDQUosTUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksNENBQVo7QUFDQUksTUFBQUEsVUFBVSxDQUFDLE1BQU07QUFDZmIsUUFBQUEsU0FBUztBQUNWLE9BRlMsRUFFUCxJQUZPLENBQVY7QUFHRCxLQU5EO0FBUUFELElBQUFBLE1BQU0sQ0FBQ0UsRUFBUCxDQUFVLE9BQVYsRUFBbUIsTUFBTTtBQUN2QkYsTUFBQUEsTUFBTSxDQUFDYSxPQUFQO0FBQ0QsS0FGRDtBQUdEO0FBQ0YsQ0F6Q0EsR0FBRCIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG5vLXVuZGVyc2NvcmUtZGFuZ2xlICovXG4oZnVuY3Rpb24gcnVuKCkge1xuICBjb25zdCBTb2NrZXQgPSB3aW5kb3cuU2ltcGxlV2Vic29ja2V0O1xuICBjb25zdCBwb3J0ID0gd2luZG93Ll9fT1BFTkFQSV9DTElfV1NfUE9SVDtcblxuICBsZXQgc29ja2V0O1xuXG4gIHJlY29ubmVjdCgpO1xuXG4gIGZ1bmN0aW9uIHJlY29ubmVjdCgpIHtcbiAgICBzb2NrZXQgPSBuZXcgU29ja2V0KGB3czovLzEyNy4wLjAuMToke3BvcnR9YCk7XG4gICAgc29ja2V0Lm9uKCdjb25uZWN0JywgKCkgPT4ge1xuICAgICAgc29ja2V0LnNlbmQoJ3tcInR5cGVcIjogXCJwaW5nXCJ9Jyk7XG4gICAgfSk7XG5cbiAgICBzb2NrZXQub24oJ2RhdGEnLCAoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICBzd2l0Y2ggKG1lc3NhZ2UudHlwZSkge1xuICAgICAgICBjYXNlICdwb25nJzpcbiAgICAgICAgICBjb25zb2xlLmxvZygnW2hvdF0gaG90IHJlbG9hZGluZyBjb25uZWN0ZWQnKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAncmVsb2FkJzpcbiAgICAgICAgICBjb25zb2xlLmxvZygnW2hvdF0gZnVsbCBwYWdlIHJlbG9hZCcpO1xuICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBjb25zb2xlLmxvZyhgW2hvdF0gJHttZXNzYWdlLnR5cGV9IHJlY2VpdmVkYCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzb2NrZXQub24oJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgc29ja2V0LmRlc3Ryb3koKTtcbiAgICAgIGNvbnNvbGUubG9nKCdDb25uZWN0aW9uIGxvc3QsIHRyeWluZyB0byByZWNvbm5lY3QgaW4gNHMnKTtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICByZWNvbm5lY3QoKTtcbiAgICAgIH0sIDQwMDApO1xuICAgIH0pO1xuXG4gICAgc29ja2V0Lm9uKCdlcnJvcicsICgpID0+IHtcbiAgICAgIHNvY2tldC5kZXN0cm95KCk7XG4gICAgfSk7XG4gIH1cbn0oKSk7XG4iXX0=